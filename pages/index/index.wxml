<!--pages/index/index.wxml-->
<view class="page">
  <!-- é¡¶éƒ¨å¡ç‰‡ -->
  <view class="header-card">
    <view class="month-picker">
      <picker mode="date" fields="month" value="{{currentYear}}-{{currentMonth}}" bindchange="dateChange">
        <view class="picker-content">
          <text class="year">{{currentYear}}å¹´</text>
          <text class="month">{{currentMonth}}æœˆ</text>
          <text class="picker-arrow">â€º</text>
        </view>
      </picker>
    </view>

    <view class="overview">
      <view class="overview-item">
        <text class="label">æœ¬æœˆæ”¯å‡º</text>
        <text class="amount expense">Â¥{{totalExpense}}</text>
      </view>
      <view class="divider"></view>
      <view class="overview-item">
        <text class="label">æœ¬æœˆæ”¶å…¥</text>
        <text class="amount income">Â¥{{totalIncome}}</text>
      </view>
    </view>
  </view>

  <!-- è´¦å•åˆ—è¡¨ -->
  <view class="bill-list">
    <block wx:for="{{bills}}" wx:key="date">
      <!-- æ—¥æœŸå¡ç‰‡ -->
      <view class="date-card">
        <view class="date-header">
          <view class="date-info">
            <text class="date">{{item.date}} {{item.dayOfWeek}}</text>
          </view>
          <view class="daily-amount">
            <block wx:if="{{item.dayExpense > 0}}">
              <text class="expense">æ”¯ {{item.dayExpense}}</text>
            </block>
            <block wx:if="{{item.dayIncome > 0}}">
              <text class="income">æ”¶ {{item.dayIncome}}</text>
            </block>
          </view>
        </view>

        <!-- å½“æ—¥è´¦å•åˆ—è¡¨ -->
        <view class="bill-items">
          <view class="bill-item" 
            wx:for="{{item.bills}}" 
            wx:key="id" 
            wx:for-item="bill"
            bindlongpress="showBillOptions"
            data-bill="{{bill}}">
            <view class="category-info">
              <view class="icon-wrap {{bill.type}}">
                <text class="icon">{{bill.category === 'é¤é¥®' ? 'ğŸ±' : 
                                   bill.category === 'äº¤é€š' ? 'ğŸšŠ' :
                                   bill.category === 'è´­ç‰©' ? 'ğŸ›ï¸' :
                                   bill.category === 'å¨±ä¹' ? 'ğŸ®' :
                                   bill.category === 'å±…ä½' ? 'ğŸ ' :
                                   bill.category === 'åŒ»ç–—' ? 'ğŸ’Š' :
                                   bill.category === 'æ•™è‚²' ? 'ğŸ“š' :
                                   bill.category === 'æ—¥ç”¨' ? 'ğŸ§´' :
                                   bill.category === 'å·¥èµ„' ? 'ğŸ’µ' :
                                   bill.category === 'å…¼èŒ' ? 'ğŸ’¼' :
                                   bill.category === 'ç†è´¢' ? 'ğŸ“ˆ' :
                                   bill.category === 'å¥–é‡‘' ? 'ğŸ' :
                                   bill.category === 'é€€æ¬¾' ? 'ğŸ”„' : 'ğŸ’°'}}</text>
              </view>
              <view class="bill-detail">
                <text class="category-name">{{bill.category}}</text>
                <text class="description" wx:if="{{bill.description}}">{{bill.description}}</text>
              </view>
            </view>
            <view class="amount-info {{bill.type}}">
              <text>{{bill.type === 'expense' ? '-' : '+'}}{{bill.amount}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!bills.length}}">
    <text class="empty-text">æœ¬æœˆæš‚æ— è´¦å•</text>
    <text class="empty-tip">ç‚¹å‡»å³ä¸‹è§’æ·»åŠ ä¸€ç¬”è´¦å•å§</text>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-button" bindtap="navigateToAdd">
    <text class="add-icon">+</text>
  </view>
</view>